Running "module reset". Resetting modules to system default. The following $MODULEPATH directories have been removed: None
A conda environment has been detected CONDA_PREFIX=
/sw/external/python/anaconda3 
anaconda3_gpu is loaded. Consider running conda deactivate and reloading it.

Currently Loaded Modules:
  1) cue-login-env/1.0   4) gcc/11.2.0    7) openmpi/4.1.2
  2) default             5) cuda/11.6.1   8) cudnn/8.4.1.50
  3) modtree/gpu         6) ucx/1.11.2    9) anaconda3_gpu/4.13.0

 

/u/avroy/UQ_XAI_Studies/models/PFIN_UQ/model/jobsub
total 41K
-rw-rw----+ 1 avroy delta_bbhj  925 Mar 31 16:58 jobsubmitter_dummy.py
-rw-rw----+ 1 avroy delta_bbhj  12K May 13 01:27 jobsubmitter.py
-rw-rw----+ 1 avroy delta_bbhj  12K May 13 01:23 jobsubmitter.py~
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 13 01:23 UQPFIN-run-jetclass_trial0_partdata.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 13 01:23 UQPFIN-run-jetclass_trial1_partdata.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 13 01:28 UQPFIN-run-jetclass_trial2_partdata.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 13 01:28 UQPFIN-run-jetclass_trial3_partdata.slurm
-rw-------+ 1 avroy delta_bbhj  969 May  2 10:38 UQPFIN-run.slurm
/projects/bbhj/avroy/UQ_XAI_Studies/models/PFIN_UQ/model
total 108K
drwxr-s---+ 2 avroy delta_bbhj  12K May 13 01:28 jobouts
drwxr-s---+ 2 avroy delta_bbhj 4.0K May 13 01:27 jobsub
-rw-rw----+ 1 avroy delta_bbhj 8.3K May  1 09:53 PFINDataset.py
drwxrws---+ 2 avroy delta_bbhj 4.0K May  5 19:52 __pycache__
drwxrws---+ 2 avroy delta_bbhj  12K May 13 01:24 trained_model_dicts
drwxr-s---+ 2 avroy delta_bbhj 4.0K Mar 31 15:09 trained_model_dicts_old
drwxrws---+ 2 avroy delta_bbhj  20K May 13 01:19 trained_models
drwxr-s---+ 2 avroy delta_bbhj 4.0K Mar 31 15:10 trained_models_old
-rw-rw----+ 1 avroy delta_bbhj  19K May 13 01:18 train.py
-rw-rw----+ 1 avroy delta_bbhj  13K May  5 09:36 UQPFIN.py
job is starting on gpua097.delta.ncsa.illinois.edu
# conda environments:
#
base                     /sw/external/python/anaconda3
toptagger_env         *  /u/avroy/.conda/envs/toptagger_env

/sw/external/python/anaconda3_gpu/bin/python
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
UQPFIN                                   [1, 10]                   --
├─Sequential: 1-1                        [60, 256]                 --
│    └─Sequential: 2-1                   [60, 100]                 --
│    │    └─Linear: 3-1                  [60, 100]                 1,200
│    │    └─ReLU: 3-2                    [60, 100]                 --
│    └─Sequential: 2-2                   [60, 100]                 --
│    │    └─Linear: 3-3                  [60, 100]                 10,100
│    │    └─ReLU: 3-4                    [60, 100]                 --
│    └─Sequential: 2-3                   [60, 100]                 --
│    │    └─Linear: 3-5                  [60, 100]                 10,100
│    │    └─ReLU: 3-6                    [60, 100]                 --
│    └─Sequential: 2-4                   [60, 256]                 --
│    │    └─Linear: 3-7                  [60, 256]                 25,856
│    │    └─ReLU: 3-8                    [60, 256]                 --
├─Sequential: 1-2                        [1770, 256]               --
│    └─Sequential: 2-5                   [1770, 512]               --
│    │    └─Linear: 3-9                  [1770, 512]               2,560
│    │    └─ReLU: 3-10                   [1770, 512]               --
│    └─Sequential: 2-6                   [1770, 512]               --
│    │    └─Linear: 3-11                 [1770, 512]               262,656
│    │    └─ReLU: 3-12                   [1770, 512]               --
│    └─Sequential: 2-7                   [1770, 256]               --
│    │    └─Linear: 3-13                 [1770, 256]               131,328
│    │    └─ReLU: 3-14                   [1770, 256]               --
├─Sequential: 1-3                        [60, 256]                 --
│    └─Sequential: 2-8                   [60, 512]                 --
│    │    └─Linear: 3-15                 [60, 512]                 137,216
│    │    └─ReLU: 3-16                   [60, 512]                 --
│    └─Sequential: 2-9                   [60, 512]                 --
│    │    └─Linear: 3-17                 [60, 512]                 262,656
│    │    └─ReLU: 3-18                   [60, 512]                 --
│    └─Sequential: 2-10                  [60, 256]                 --
│    │    └─Linear: 3-19                 [60, 256]                 131,328
│    │    └─ReLU: 3-20                   [60, 256]                 --
├─Sequential: 1-4                        [1, 10]                   --
│    └─Sequential: 2-11                  [1, 256]                  --
│    │    └─Linear: 3-21                 [1, 256]                  65,792
│    │    └─ReLU: 3-22                   [1, 256]                  --
│    └─Sequential: 2-12                  [1, 100]                  --
│    │    └─Linear: 3-23                 [1, 100]                  25,700
│    │    └─ReLU: 3-24                   [1, 100]                  --
│    └─Sequential: 2-13                  [1, 100]                  --
│    │    └─Linear: 3-25                 [1, 100]                  10,100
│    │    └─ReLU: 3-26                   [1, 100]                  --
│    └─Sequential: 2-14                  [1, 100]                  --
│    │    └─Linear: 3-27                 [1, 100]                  10,100
│    │    └─ReLU: 3-28                   [1, 100]                  --
│    └─Linear: 2-15                      [1, 10]                   1,010
│    └─Softmax: 2-16                     [1, 10]                   --
==========================================================================================
Total params: 1,087,702
Trainable params: 1,087,702
Non-trainable params: 0
Total mult-adds (M): 736.70
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 19.01
Params size (MB): 4.35
Estimated Total Size (MB): 23.36
==========================================================================================
data type:  jetclass
m_logic, pt_logic, eta_logic:  AND AND AND
m1, m2, pt1, pt2, eta1, eta2:  0.0 10000.0 0.0 10000.0 -6.0 6.0
skip labels:  []
classes:  10
Epoch 0
Best Validation Accuracy: 0
Current Validation Accuracy: 0.7032174800408187
Current Validation Loss: 0.0008336506866403594
Saving best model based on accuracy
Epoch 1
Best Validation Accuracy: 0.7032174800408187
Current Validation Accuracy: 0.710893010784961
Current Validation Loss: 0.0008084442559598
Saving best model based on accuracy
Epoch 2
Best Validation Accuracy: 0.710893010784961
Current Validation Accuracy: 0.7208195770054225
Current Validation Loss: 0.0007808240243509222
Saving best model based on accuracy
Epoch 3
Best Validation Accuracy: 0.7208195770054225
Current Validation Accuracy: 0.727816795726034
Current Validation Loss: 0.0007631996576269437
Saving best model based on accuracy
Epoch 4
Best Validation Accuracy: 0.727816795726034
Current Validation Accuracy: 0.7294845628989335
Current Validation Loss: 0.0007597115820552425
Saving best model based on accuracy
Epoch 5
Best Validation Accuracy: 0.7294845628989335
Current Validation Accuracy: 0.7321017668127339
Current Validation Loss: 0.0007504471677867205
Saving best model based on accuracy
Epoch 6
Best Validation Accuracy: 0.7321017668127339
Current Validation Accuracy: 0.7330161874462252
Current Validation Loss: 0.0007471110229363191
Saving best model based on accuracy
Epoch 7
Best Validation Accuracy: 0.7330161874462252
Current Validation Accuracy: 0.7285581367429017
Current Validation Loss: 0.0007536587380112073
Epoch 8
Best Validation Accuracy: 0.7330161874462252
Current Validation Accuracy: 0.732117774176121
Current Validation Loss: 0.000745993684870328
Epoch 9
Best Validation Accuracy: 0.7330161874462252
Current Validation Accuracy: 0.7362556776117014
Current Validation Loss: 0.0007383114151143941
Saving best model based on accuracy
Epoch 10
Best Validation Accuracy: 0.7362556776117014
Current Validation Accuracy: 0.7363787342177401
Current Validation Loss: 0.0007383366728166736
Saving best model based on accuracy
Epoch 11
Best Validation Accuracy: 0.7363787342177401
Current Validation Accuracy: 0.7369970186285691
Current Validation Loss: 0.0007365232008732455
Saving best model based on accuracy
Epoch 12
Best Validation Accuracy: 0.7369970186285691
Current Validation Accuracy: 0.7365298037097064
Current Validation Loss: 0.000737300404915158
Epoch 13
Best Validation Accuracy: 0.7369970186285691
Current Validation Accuracy: 0.7378464093483003
Current Validation Loss: 0.0007335848769837812
Saving best model based on accuracy
Epoch 14
Best Validation Accuracy: 0.7378464093483003
Current Validation Accuracy: 0.7385007103267504
Current Validation Loss: 0.000732450476690179
Saving best model based on accuracy
Epoch 15
Best Validation Accuracy: 0.7385007103267504
Current Validation Accuracy: 0.7397242731656563
Current Validation Loss: 0.0007290036284694804
Saving best model based on accuracy
Epoch 16
Best Validation Accuracy: 0.7397242731656563
Current Validation Accuracy: 0.7398493306921183
Current Validation Loss: 0.0007288104947866968
Saving best model based on accuracy
Epoch 17
Best Validation Accuracy: 0.7398493306921183
Current Validation Accuracy: 0.7400204093883186
Current Validation Loss: 0.0007279343321502911
Saving best model based on accuracy
Epoch 18
Best Validation Accuracy: 0.7400204093883186
Current Validation Accuracy: 0.7401564719771094
Current Validation Loss: 0.0007276089140105477
Saving best model based on accuracy
Epoch 19
Best Validation Accuracy: 0.7401564719771094
Current Validation Accuracy: 0.7402745262820898
Current Validation Loss: 0.0007273510034949176
Saving best model based on accuracy
Epoch 20
Best Validation Accuracy: 0.7402745262820898
Current Validation Accuracy: 0.7403605658602957
Current Validation Loss: 0.0007273268175599317
Validation Accuracy has not changed much, will stop in 4 epochs if this continues
Saving best model based on accuracy
Epoch 21
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7402565179982792
Current Validation Loss: 0.000727986332572427
Epoch 22
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7395641995317846
Current Validation Loss: 0.0007296475937026964
Epoch 23
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7398133141244972
Current Validation Loss: 0.0007289414447374384
Epoch 24
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7398173159653441
Current Validation Loss: 0.0007293457487187308
Epoch 25
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7398353242491547
Current Validation Loss: 0.0007291146949991176
Epoch 26
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7394691558116734
Current Validation Loss: 0.0007299084257129709
Epoch 27
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7393470996658463
Current Validation Loss: 0.0007305539584945563
Epoch 28
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7392460531844649
Current Validation Loss: 0.0007304386909448301
Epoch 29
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.739133001180543
Current Validation Loss: 0.0007318456074979541
Epoch 30
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7385457310362767
Current Validation Loss: 0.0007331180311202011
Epoch 31
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7385487324169118
Current Validation Loss: 0.000733164604486775
Epoch 32
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7383526422154191
Current Validation Loss: 0.0007338276882404625
Epoch 33
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7384086679872741
Current Validation Loss: 0.0007346848846567177
Epoch 34
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.737850411189147
Current Validation Loss: 0.0007359564795720109
Epoch 35
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7379784700962443
Current Validation Loss: 0.0007366319381740124
Epoch 36
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7377463633271305
Current Validation Loss: 0.0007378936649349186
Epoch 37
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7374652340076435
Current Validation Loss: 0.0007390437856748005
Epoch 38
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.736765912319667
Current Validation Loss: 0.0007409266834869475
Epoch 39
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7367439021950097
Current Validation Loss: 0.0007415902939111261
Epoch 40
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7362016527602697
Current Validation Loss: 0.0007435442122729559
Epoch 41
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.735873501810833
Current Validation Loss: 0.0007442355832172561
Epoch 42
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7355753646677472
Current Validation Loss: 0.0007462414511350613
Epoch 43
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7353292514556696
Current Validation Loss: 0.0007474505677358594
Epoch 44
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7356013766332513
Current Validation Loss: 0.0007473653279177665
Epoch 45
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7351271584929068
Current Validation Loss: 0.0007483295647444472
Epoch 46
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7349280669107789
Current Validation Loss: 0.0007499527174005284
Epoch 47
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.7338525721832043
Current Validation Loss: 0.000753010795735978
Epoch 48
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.09977389599215639
Current Validation Loss: nan
Validation accuracy dropped by more than 10%. Reloading best model
Epoch 49
Best Validation Accuracy: 0.7403605658602957
Current Validation Accuracy: 0.09977389599215639
Current Validation Loss: nan
Validation accuracy dropped by more than 10%. Reloading best model
Saving last model
