Running "module reset". Resetting modules to system default. The following $MODULEPATH directories have been removed: None
A conda environment has been detected CONDA_PREFIX=
/sw/external/python/anaconda3 
anaconda3_gpu is loaded. Consider running conda deactivate and reloading it.

Currently Loaded Modules:
  1) cue-login-env/1.0   4) gcc/11.2.0    7) openmpi/4.1.2
  2) default             5) cuda/11.6.1   8) cudnn/8.4.1.50
  3) modtree/gpu         6) ucx/1.11.2    9) anaconda3_gpu/4.13.0

 

/u/avroy/UQ_XAI_Studies/models/PFIN_UQ/model/jobsub
total 30K
-rw-rw----+ 1 avroy delta_bbhj  925 Mar 31 16:58 jobsubmitter_dummy.py
-rw-rw----+ 1 avroy delta_bbhj  12K May 16 16:35 jobsubmitter.py
-rw-rw----+ 1 avroy delta_bbhj  12K May 16 16:33 jobsubmitter.py~
-rw-rw----+ 1 avroy delta_bbhj 1.3K May 16 16:35 UQPFIN-run-jetclass_trial0_20Mdata_2.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 15 17:45 UQPFIN-run-jetclass_trial0_20Mdata.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 15 09:44 UQPFIN-run-jetclass_trial0_fulldata.slurm
-rw-rw----+ 1 avroy delta_bbhj 1.2K May 16 16:35 UQPFIN-run-jetclass_trial1_20Mdata.slurm
-rw-------+ 1 avroy delta_bbhj  969 May 15 09:44 UQPFIN-run.slurm
/projects/bbhj/avroy/UQ_XAI_Studies/models/PFIN_UQ/model
total 176K
drwxr-s---+ 2 avroy delta_bbhj  12K May 16 16:35 jobouts
drwxr-s---+ 2 avroy delta_bbhj 4.0K May 16 16:35 jobsub
-rw-rw----+ 1 avroy delta_bbhj 8.4K May 15 14:46 PFINDataset.py
drwxrws---+ 2 avroy delta_bbhj 4.0K May 15 14:47 __pycache__
drwxrws---+ 2 avroy delta_bbhj  12K May 16 13:06 trained_model_dicts
drwxr-s---+ 2 avroy delta_bbhj 4.0K Mar 31 15:09 trained_model_dicts_old
drwxrws---+ 2 avroy delta_bbhj  20K May 16 13:12 trained_models
drwxr-s---+ 2 avroy delta_bbhj 4.0K Mar 31 15:10 trained_models_old
-rw-rw----+ 1 avroy delta_bbhj  23K May 16 13:56 train_mod.py
-rw-rw----+ 1 avroy delta_bbhj  23K May 16 13:38 train_mod.py~
-rw-rw----+ 1 avroy delta_bbhj  19K May 16 16:31 train.py
-rw-rw----+ 1 avroy delta_bbhj  19K May 16 13:02 train.py~
-rw-rw----+ 1 avroy delta_bbhj  13K May  5 09:36 UQPFIN.py
job is starting on gpua098.delta.ncsa.illinois.edu
# conda environments:
#
base                     /sw/external/python/anaconda3
toptagger_env         *  /u/avroy/.conda/envs/toptagger_env

/sw/external/python/anaconda3_gpu/bin/python
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
UQPFIN                                   [1, 10]                   --
├─Sequential: 1-1                        [60, 256]                 --
│    └─Sequential: 2-1                   [60, 100]                 --
│    │    └─Linear: 3-1                  [60, 100]                 1,200
│    │    └─ReLU: 3-2                    [60, 100]                 --
│    └─Sequential: 2-2                   [60, 100]                 --
│    │    └─Linear: 3-3                  [60, 100]                 10,100
│    │    └─ReLU: 3-4                    [60, 100]                 --
│    └─Sequential: 2-3                   [60, 100]                 --
│    │    └─Linear: 3-5                  [60, 100]                 10,100
│    │    └─ReLU: 3-6                    [60, 100]                 --
│    └─Sequential: 2-4                   [60, 256]                 --
│    │    └─Linear: 3-7                  [60, 256]                 25,856
│    │    └─ReLU: 3-8                    [60, 256]                 --
├─Sequential: 1-2                        [1770, 256]               --
│    └─Sequential: 2-5                   [1770, 512]               --
│    │    └─Linear: 3-9                  [1770, 512]               2,560
│    │    └─ReLU: 3-10                   [1770, 512]               --
│    └─Sequential: 2-6                   [1770, 512]               --
│    │    └─Linear: 3-11                 [1770, 512]               262,656
│    │    └─ReLU: 3-12                   [1770, 512]               --
│    └─Sequential: 2-7                   [1770, 256]               --
│    │    └─Linear: 3-13                 [1770, 256]               131,328
│    │    └─ReLU: 3-14                   [1770, 256]               --
├─Sequential: 1-3                        [60, 256]                 --
│    └─Sequential: 2-8                   [60, 512]                 --
│    │    └─Linear: 3-15                 [60, 512]                 137,216
│    │    └─ReLU: 3-16                   [60, 512]                 --
│    └─Sequential: 2-9                   [60, 512]                 --
│    │    └─Linear: 3-17                 [60, 512]                 262,656
│    │    └─ReLU: 3-18                   [60, 512]                 --
│    └─Sequential: 2-10                  [60, 256]                 --
│    │    └─Linear: 3-19                 [60, 256]                 131,328
│    │    └─ReLU: 3-20                   [60, 256]                 --
├─Sequential: 1-4                        [1, 10]                   --
│    └─Sequential: 2-11                  [1, 256]                  --
│    │    └─Linear: 3-21                 [1, 256]                  65,792
│    │    └─ReLU: 3-22                   [1, 256]                  --
│    └─Sequential: 2-12                  [1, 100]                  --
│    │    └─Linear: 3-23                 [1, 100]                  25,700
│    │    └─ReLU: 3-24                   [1, 100]                  --
│    └─Sequential: 2-13                  [1, 100]                  --
│    │    └─Linear: 3-25                 [1, 100]                  10,100
│    │    └─ReLU: 3-26                   [1, 100]                  --
│    └─Sequential: 2-14                  [1, 100]                  --
│    │    └─Linear: 3-27                 [1, 100]                  10,100
│    │    └─ReLU: 3-28                   [1, 100]                  --
│    └─Linear: 2-15                      [1, 10]                   1,010
│    └─Softmax: 2-16                     [1, 10]                   --
==========================================================================================
Total params: 1,087,702
Trainable params: 1,087,702
Non-trainable params: 0
Total mult-adds (M): 736.70
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 19.01
Params size (MB): 4.35
Estimated Total Size (MB): 23.36
==========================================================================================
data type:  jetclass
m_logic, pt_logic, eta_logic:  AND AND AND
m1, m2, pt1, pt2, eta1, eta2:  0.0 10000.0 0.0 10000.0 -6.0 6.0
skip labels:  []
classes:  10
Epoch 0
Traceback (most recent call last):
  File "/projects/bbhj/avroy/UQ_XAI_Studies/models/PFIN_UQ/model/train.py", line 310, in <module>
    loss.backward()
  File "/sw/external/python/anaconda3_gpu/lib/python3.9/site-packages/torch/_tensor.py", line 400, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/sw/external/python/anaconda3_gpu/lib/python3.9/site-packages/torch/autograd/__init__.py", line 191, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 6.91 GiB (GPU 0; 39.43 GiB total capacity; 21.07 GiB already allocated; 3.46 GiB free; 34.81 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
